{"version":3,"file":"index.js","sources":["../src/utils/shallowEqual.ts","../src/utils/getDiff.ts","../src/utils/set.tsx","../src/utils/bindActions.ts","../src/svelte/components/connect.ts"],"sourcesContent":["export default function shallowEqual(a, b) {\n  for (const i in a) if (a[i] !== b[i]) return false\n  for (const i in b) if (!(i in a)) return false\n  return true\n}\n","import shallowEqual from \"./shallowEqual\"\r\n\r\nfunction differs(a, b) {\r\n  if (a !== b) {\r\n    return true\r\n  } else if (a && typeof a === \"object\") {\r\n    return !shallowEqual(a, b)\r\n  }\r\n  return false\r\n}\r\n\r\nexport default function getDiff(newData, oldData) {\r\n  const diff = {}\r\n  let changed = false\r\n  for (let key in newData) {\r\n    const val = newData[key]\r\n    if (differs(oldData[key], val)) {\r\n      changed = true\r\n      if (typeof val === \"object\" && typeof val.getMonth !== \"function\") {\r\n        diff[key] = val.constructor === Array ? val.slice(0) : { ...val }\r\n      } else {\r\n        diff[key] = val\r\n      }\r\n    }\r\n  }\r\n  return { diff, changed }\r\n}\r\n","export default function set(store, ret) {\n  if (ret != null) {\n    if (ret.then) return ret.then(store.setState)\n    store.setState(ret)\n  }\n}\n","import set from \"./set\"\n\nexport default function bindActions(actions, store) {\n  actions = typeof actions === \"function\" ? actions(store) : actions\n\n  let bound = {}\n  for (let name in actions) {\n    bound[name] = (...args) => {\n      const action = actions[name]\n\n      if (typeof store.middleware === \"function\") {\n        return store.middleware(store, action, args)\n      }\n\n      return set(store, action(store.getState(), ...args))\n    }\n  }\n\n  return bound\n}\n","import getDiff from \"../../utils/getDiff\"\nimport bindActions from \"../../utils/bindActions\"\n\nexport function getActions(store, actions) {\n  return bindActions(actions, store)\n}\n\nexport function connect(component, store, mapToProps) {\n  update()\n  component.on(\"destroy\", store.subscribe(update))\n  function update() {\n    const { diff, changed } = getDiff(\n      mapToProps(store.getState()),\n      component.get()\n    )\n    if (changed) {\n      component.set(diff)\n    }\n  }\n}\n"],"names":[],"mappings":"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"}