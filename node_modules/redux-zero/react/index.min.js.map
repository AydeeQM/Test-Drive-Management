{"version":3,"file":"index.min.js","sources":["../src/utils/shallowEqual.ts","../src/utils/propsValidation.ts","../src/utils/set.tsx","../src/utils/bindActions.ts","../src/react/components/connect.tsx","../src/react/components/Provider.tsx"],"sourcesContent":["export default function shallowEqual(a, b) {\n  for (const i in a) if (a[i] !== b[i]) return false\n  for (const i in b) if (!(i in a)) return false\n  return true\n}\n","export default function propsValidation(\n  props: object,\n  propName: string,\n  componentName: string\n) {\n  if (typeof props === \"object\") {\n    return null\n  }\n  return new Error(`Invalid prop ${propName} supplied to ${componentName}`)\n}\n","export default function set(store, ret) {\n  if (ret != null) {\n    if (ret.then) return ret.then(store.setState)\n    store.setState(ret)\n  }\n}\n","import set from \"./set\"\n\nexport default function bindActions(actions, store) {\n  actions = typeof actions === \"function\" ? actions(store) : actions\n\n  let bound = {}\n  for (let name in actions) {\n    bound[name] = (...args) => {\n      const action = actions[name]\n\n      if (typeof store.middleware === \"function\") {\n        return store.middleware(store, action, args)\n      }\n\n      return set(store, action(store.getState(), ...args))\n    }\n  }\n\n  return bound\n}\n","import * as React from \"react\"\n\nimport shallowEqual from \"../../utils/shallowEqual\"\nimport propValidation from \"../../utils/propsValidation\"\nimport bindActions from \"../../utils/bindActions\"\n\nexport class Connect extends React.Component<any> {\n  static contextTypes = {\n    store: propValidation\n  }\n  unsubscribe\n  state = this.getProps()\n  actions = this.getActions()\n  componentWillMount() {\n    this.unsubscribe = this.context.store.subscribe(this.update)\n  }\n  componentWillUnmount() {\n    this.unsubscribe(this.update)\n  }\n  getProps() {\n    const { mapToProps } = this.props\n    const state = (this.context.store && this.context.store.getState()) || {}\n    return mapToProps ? mapToProps(state, this.props) : state\n  }\n  getActions() {\n    const { actions } = this.props\n    return bindActions(actions, this.context.store)\n  }\n  update = () => {\n    const mapped = this.getProps()\n    if (!shallowEqual(mapped, this.state)) {\n      this.setState(mapped)\n    }\n  }\n  render() {\n    return this.props.children({\n      store: this.context.store,\n      ...this.state,\n      ...this.actions\n    })\n  }\n}\n\nexport default function connect(mapToProps, actions = {}) {\n  return Child => props => (\n    <Connect {...props} mapToProps={mapToProps} actions={actions}>\n      {mappedProps => <Child {...mappedProps} {...props} />}\n    </Connect>\n  )\n}\n","import * as React from \"react\"\n\nimport Props from \"../../interfaces/Props\"\nimport Store from \"../../interfaces/Store\"\nimport propValidation from \"../../utils/propsValidation\"\n\nexport default class Provider extends React.Component<Props, {}> {\n  static childContextTypes = {\n    store: propValidation\n  }\n  getChildContext() {\n    const { store } = this.props\n    return { store }\n  }\n  render() {\n    const { children } = this.props\n    return React.Children.only(children)\n  }\n}\n"],"names":["a","b","i","props","propName","componentName","Error","store","ret","then","setState","actions","bound","name_1","_i","args","action","middleware","set","getState","_this","getProps","getActions","mapped","shallowEqual","state","tslib_1.__extends","Connect","this","unsubscribe","context","subscribe","update","mapToProps","bindActions","children","propValidation","React.Component","Provider","React.Children","only","Child","React.createElement","mappedProps"],"mappings":"2WAAqCA,EAAGC,GACtC,IAAK,IAAMC,KAAKF,EAAG,GAAIA,EAAEE,KAAOD,EAAEC,GAAI,OAAO,EAC7C,IAAK,IAAMA,KAAKD,EAAG,KAAMC,KAAKF,GAAI,OAAO,EACzC,OAAO,aCFPG,EACAC,EACAC,GAEA,MAAqB,iBAAVF,EACF,KAEF,IAAIG,MAAM,gBAAgBF,kBAAwBC,cCR/BE,EAAOC,GACjC,GAAW,MAAPA,EAAa,CACf,GAAIA,EAAIC,KAAM,OAAOD,EAAIC,KAAKF,EAAMG,UACpCH,EAAMG,SAASF,eCDiBG,EAASJ,GAC3CI,EAA6B,mBAAZA,EAAyBA,EAAQJ,GAASI,EAE3D,IAAIC,KACJ,IAAK,IAAIC,KAAQF,YAARE,GACPD,EAAMC,GAAQ,eAAC,aAAAC,mBAAAA,IAAAC,kBACb,IAAMC,EAASL,EAAQE,GAEvB,MAAgC,mBAArBN,EAAMU,WACRV,EAAMU,WAAWV,EAAOS,EAAQD,GAGlCG,EAAIX,EAAOS,gBAAOT,EAAMY,mBAAeJ,OARzCF,GAYT,OAAOD,gVCZT,aAAA,qDAKEQ,QAAQA,EAAKC,WACbD,UAAUA,EAAKE,aAgBfF,SAAS,WACP,IAAMG,EAASH,EAAKC,WACfG,EAAaD,EAAQH,EAAKK,QAC7BL,EAAKV,SAASa,MAUpB,OAnC6BG,OAO3BC,+BAAA,WACEC,KAAKC,YAAcD,KAAKE,QAAQvB,MAAMwB,UAAUH,KAAKI,SAEvDL,iCAAA,WACEC,KAAKC,YAAYD,KAAKI,SAExBL,qBAAA,WACU,IAAAM,wBACFR,EAASG,KAAKE,QAAQvB,OAASqB,KAAKE,QAAQvB,MAAMY,eACxD,OAAOc,EAAaA,EAAWR,EAAOG,KAAKzB,OAASsB,GAEtDE,uBAAA,WAEE,OAAOO,qBAAqBN,KAAKE,QAAQvB,QAQ3CoB,mBAAA,WACE,OAAOC,KAAKzB,MAAMgC,YAChB5B,MAAOqB,KAAKE,QAAQvB,OACjBqB,KAAKH,MACLG,KAAKjB,WA/BLgB,gBACLpB,MAAO6B,MAFkBC,2BCA7B,4DAYA,OAZsCX,OAIpCY,4BAAA,WAEE,OAAS/B,yBAEX+B,mBAAA,WACU,IAAAH,sBACR,OAAOI,WAAeC,KAAKL,IATtBG,qBACL/B,MAAO6B,MAF2BC,gCDqCNJ,EAAYtB,GAC1C,oBAD0CA,MACnC,SAAA8B,GAAS,OAAA,SAAAtC,GAAS,OACvBuC,gBAACf,OAAYxB,GAAO8B,WAAYA,EAAYtB,QAASA,IAClD,SAAAgC,GAAe,OAAAD,gBAACD,OAAUE,EAAiBxC"}