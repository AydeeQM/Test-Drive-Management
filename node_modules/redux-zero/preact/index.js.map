{"version":3,"file":"index.js","sources":["../src/utils/shallowEqual.ts","../src/utils/set.tsx","../src/utils/bindActions.ts","../src/preact/components/Connect.tsx","../src/preact/components/Provider.tsx"],"sourcesContent":["export default function shallowEqual(a, b) {\n  for (const i in a) if (a[i] !== b[i]) return false\n  for (const i in b) if (!(i in a)) return false\n  return true\n}\n","export default function set(store, ret) {\n  if (ret != null) {\n    if (ret.then) return ret.then(store.setState)\n    store.setState(ret)\n  }\n}\n","import set from \"./set\"\n\nexport default function bindActions(actions, store) {\n  actions = typeof actions === \"function\" ? actions(store) : actions\n\n  let bound = {}\n  for (let name in actions) {\n    bound[name] = (...args) => {\n      const action = actions[name]\n\n      if (typeof store.middleware === \"function\") {\n        return store.middleware(store, action, args)\n      }\n\n      return set(store, action(store.getState(), ...args))\n    }\n  }\n\n  return bound\n}\n","import { Component } from \"preact\"\n\nimport shallowEqual from \"../../utils/shallowEqual\"\nimport bindActions from \"../../utils/bindActions\"\n\nexport default class Connect extends Component<any, {}> {\n  unsubscribe\n  state = this.getProps()\n  actions = this.getActions()\n  componentWillMount() {\n    this.unsubscribe = this.context.store.subscribe(this.update)\n  }\n  componentWillUnmount() {\n    this.unsubscribe(this.update)\n  }\n  getProps() {\n    const { mapToProps } = this.props\n    const state = (this.context.store && this.context.store.getState()) || {}\n    return mapToProps ? mapToProps(state, this.props) : state\n  }\n  getActions() {\n    const { actions } = this.props\n    return bindActions(actions, this.context.store)\n  }\n  update = () => {\n    const mapped = this.getProps()\n    if (!shallowEqual(mapped, this.state)) {\n      this.setState(mapped)\n    }\n  }\n  render({ children }, state, { store }) {\n    return children[0]({ store, ...state, ...this.actions })\n  }\n}\n","import { Component } from \"preact\"\n\nimport Props from \"../../interfaces/Props\"\nimport Store from \"../../interfaces/Store\"\n\nexport default class Provider extends Component<Props, {}> {\n  getChildContext() {\n    return { store: this.props.store }\n  }\n  render() {\n    return this.props.children[0]\n  }\n}\n"],"names":["tslib_1.__extends","Component"],"mappings":"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"}